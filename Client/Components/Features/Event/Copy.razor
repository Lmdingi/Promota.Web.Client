<EditForm Model="@newEvent" OnValidSubmit="HandleValidSubmit" class="shadow p-4 rounded bg-white">
    <DataAnnotationsValidator />
    <ValidationSummary class="text-danger mb-3" />

    <!-- 📌 Basic Info -->
    <div class="card mb-4">
        <div class="card-header fw-bold"><i class="bi bi-pin-angle"></i> Basic Information</div>

        <div class="card-body">
            <div class="mb-3">
                <label class="form-label">Event Title *</label>
                <InputText class="form-control" @bind-Value="newEvent.Title" />
            </div>

            <div class="mb-3">
                <label class="form-label">Description *</label>
                <InputTextArea class="form-control" @bind-Value="newEvent.Description" rows="3" />
            </div>

            <div class="mb-3 mt-2">
                <label class="form-label">Price</label>
                <div class="input-group">
                    <select class="form-select" @bind="selectedCurrency" style="max-width: 100px;">
                        @foreach (var currency in currencies)
                        {
                            <option value="@currency">@currency</option>
                        }
                    </select>
                    <InputNumber class="form-control" @bind-Value="price" placeholder="Amount" />
                </div>
            </div>
        </div>
    </div>

    <!-- 🗓 Date & Time -->
    <div class="card mb-4">
        <div class="card-header fw-bold"><i class="bi bi-calendar-date"></i> Date & Time</div>

                <div class="card-body">
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label class="form-label">Start Date & Time *</label>
                    <InputDate class="form-control" @bind-Value="newEvent.StartDateTime" />
                </div>
                <div class="col-md-6 mb-3">
                    <label class="form-label">End Date & Time (optional)</label>
                    <InputDate class="form-control" @bind-Value="newEvent.EndDateTime" />
                </div>
            </div>
        </div> 
    </div>

    <!-- 📍 Location & Category -->
    <div class="card mb-4">
        <div class="card-header fw-bold">📍 Location & Category</div>

        @*   <div class="card-body">
            <div class="mb-3">
                <label class="form-label">Location</label>
                <InputText class="form-control" @bind-Value="newEvent.Location" />
            </div>
            <div class="mb-3">
                <label class="form-label">Category</label>
                <InputSelect class="form-select" @bind-Value="newEvent.Category">
                    <option disabled value="">-- Select Category --</option>
                    <option>Music</option>
                    <option>Party</option>
                    <option>Seminar</option>
                    <option>Networking</option>
                    <option>Tech</option>
                </InputSelect>
            </div>
        </div>
    </div>

    <!-- 🖼 Media Uploads -->
    <div class="card mb-4">
        <div class="card-header fw-bold"><i class="bi bi-collection"></i> Media</div>

        @*         <div class="card-body">  
            <div class="mb-3">  
                <label class="form-label">Thumbnail (Required)</label>  
                <InputFile OnChange="@((e) => HandleFileChange(e, "Thumbnail"))" />  
            </div>  

            <div class="mb-3">  
                <label class="form-label">Banner (Image or Video)</label>  
                <InputFile OnChange="@((e) => HandleFileChange(e, "Banner"))" />  
            </div>  

            <div class="mb-3">  
                <label class="form-label">Gallery (Optional - Multiple Images/Videos)</label>  
                <InputFile OnChange="HandleGalleryChange" Multiple />  
            </div>  
        </div>   *@
    </div>

    <!-- 🔗 External Links -->
    <div class="card mb-4">
        <div class="card-header fw-bold"><i class="bi bi-link-45deg"></i> External Links</div>

        @*         <div class="card-body">
            <div class="mb-3">
                <label class="form-label">Ticket/Website Link</label>
                <InputText class="form-control" @bind-Value="newEvent.ExternalLink" />
            </div>
        </div> *@
    </div>

    <!-- ✅ Submit -->
    <div class="d-grid">
        <button type="submit" class="btn btn-success btn-lg">Create Event</button>
    </div>

    @if (success)
    {
        <div class="alert alert-success mt-4 text-center">
            ✅ Event created successfully!
        </div>
    }
</EditForm>

@code {
    private string selectedCurrency = "ZAR";
    private List<string> currencies = new() { "ZAR", "USD", "EUR", "GBP" };

    private decimal? price;

    private EventModel newEvent = new();
    private bool success = false;

    private IBrowserFile? Thumbnail;
    private IBrowserFile? Banner;
    private List<IBrowserFile> Gallery = new();

    private void HandleValidSubmit()
    {
        success = true;
        Console.WriteLine($"✅ Created event: {newEvent.Title}");
    }

    private void HandleFileChange(InputFileChangeEventArgs e, string type)
    {
        if (type == "Thumbnail") Thumbnail = e.File;
        else if (type == "Banner") Banner = e.File;
    }

    private void HandleGalleryChange(InputFileChangeEventArgs e)
    {
        Gallery = e.GetMultipleFiles().ToList();
    }

    public class EventModel
    {
        [Required] public string Title { get; set; }
        [Required] public string Description { get; set; }
        public bool IsOnline { get; set; }
        public bool IsFree { get; set; } = true;
        public decimal? Price { get; set; }
        public string TicketLink { get; set; }


        [Required] public DateTime StartDateTime { get; set; } = DateTime.Now;
        public DateTime? EndDateTime { get; set; }
        [Required] public string TimeZone { get; set; }

        public string Location { get; set; }
        public string Category { get; set; }
        public string ExternalLink { get; set; }
    }
}
