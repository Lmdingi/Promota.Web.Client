@page "/"
@rendermode InteractiveServer
@inject IAuthService _authService
@inject NavigationManager _navigationManager
@inject IAccessTokenService _AccessTokenService
@inject IAuthService _AuthService
@inject IResourceService _ResourceService
@inject IEventService _eventService
@inject ILogger<Home> _logger
@inject IUserService _userService
@inject GlobalEventCallBacks _globalEventCallBacks

@foreach (var eventModel in _events)
{
    <EventCard Event="eventModel"></EventCard>
}








                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <div class="flex flex-col sm:flex-row items-start sm:items-center">
                        <div class="icon-placeholder flex-shrink-0 mr-6 mb-4 sm:mb-0">
                            <img alt="Event placeholder image" class="opacity-0 w-full h-full object-cover rounded-full" src="https://lh3.googleusercontent.com/aida-public/AB6AXuDv1Z4V0wsh_wHXVeyiWJZAvQ9tIzVs37z7pSoMuuwDXZnwXvMLWL_23IhL3k1HyxWao7xZ7qWIzEjrqOWC5f0d7_w7Wk1nbpke3DAAICusyuhTfsipT6iwhoOJ8uDpwkAxlZiSRkcX9AGw_AaUH2BywlkCNn8Ebqm7h3Y2UVbzosjixq25nIdk5YH9S4q3gJ8ypNR19pt8KtHrpWaZmM9Xopex25rvlez695QBWr5sU2Wn5UlMhBrfud4s7U11uoX2BkGqfrEUSj0" />
                        </div>

                        <div class="flex-grow">
                            <div class="flex justify-between items-start mb-2">
                                <div>
                                    <p class="text-sm text-gray-500">Evelyn Carter</p>
                                    <h2 class="text-2xl font-bold text-gray-800">Friday Night Games</h2>
                                </div>
                                <div class="flex items-center text-gray-500">
                                    <span class="material-icons text-yellow-400">star</span>
                                    <span class="material-icons text-yellow-400">star</span>
                                    <span class="material-icons text-yellow-400">star</span>
                                    <span class="material-icons text-yellow-400">star_half</span>
                                    <span class="material-icons text-gray-300">star_border</span>
                                    <span class="ml-4 flex items-center text-sm">
                                        <span class="material-icons text-gray-400 mr-1">group</span> 200
                                    </span>
                                </div>
                            </div>

                            <p class="text-sm text-gray-500 mb-1">31 Jan 2025</p>

                            <div class="flex items-center text-sm text-gray-600 mb-1">
                                <span class="material-icons text-gray-400 mr-1 text-base">location_on</span>
                                Cape Town
                            </div>

                            <p class="text-lg font-semibold text-pink-500">R 90.00</p>
                        </div>
                    </div>

                    <div class="mt-6 grid grid-cols-2 sm:grid-cols-5 gap-2">
                        <button class="col-span-2 sm:col-span-1 bg-pink-500 hover:bg-pink-600 text-white font-medium py-2 px-3 rounded-md flex items-center justify-center text-sm">
                            <span class="material-icons mr-1 text-base">person_add</span> Attend <span class="ml-1 bg-pink-700 text-white text-xs px-1.5 py-0.5 rounded-full">256</span>
                        </button>
                        <button class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-3 rounded-md text-sm">Details</button>
                        <button class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-3 rounded-md text-sm">Comments</button>
                        <button class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-3 rounded-md text-sm">Message</button>
                        <button class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-3 rounded-md text-sm">Share</button>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <div class="flex flex-col sm:flex-row items-start sm:items-center">
                        <div class="icon-placeholder flex-shrink-0 mr-6 mb-4 sm:mb-0">
                            <img alt="Event placeholder image" class="opacity-0 w-full h-full object-cover rounded-full" src="https://lh3.googleusercontent.com/aida-public/AB6AXuC6jcpAOLQ0FILcVUV5anKmZrBKbzRlKuwzQHWjJa7xIWhEUjtRFCxxKTJG1n3at80KiavGeIVF-hzUToPX_yN5I5BwuT4wFQM8MP9boWh9XkSebS4HT83EM_x8DGTcOFGCusAs4AClITcbv7XRuBth1K6yT0MR9Oz9gDCJeF_ot7EFRZIDc1TXjWKCEGDmnOBOSVF9OwBZ-u0WzJq4ysRGlAf-ojn1v25DcKdaMo0GUEpXu2OdSWJ0jaLtjMih3w18xfYT83jvvvI" />
                        </div>
                        <div class="flex-grow">
                            <div class="flex justify-between items-start mb-2">
                                <div>
                                    <p class="text-sm text-gray-500">Noah Brooks</p>
                                    <h2 class="text-2xl font-bold text-gray-800">Startup Summit 2025</h2>
                                </div>
                                <div class="flex items-center text-gray-500">
                                    <span class="material-icons text-yellow-400">star</span>
                                    <span class="material-icons text-yellow-400">star</span>
                                    <span class="material-icons text-yellow-400">star</span>
                                    <span class="material-icons text-yellow-400">star</span>
                                    <span class="material-icons text-gray-300">star_border</span>
                                    <span class="ml-4 flex items-center text-sm">
                                        <span class="material-icons text-gray-400 mr-1">group</span> 10K
                                    </span>
                                </div>
                            </div>
                            <p class="text-sm text-gray-500 mb-1">29 Oct 2024 - 31 Jan 2025</p>
                            <div class="flex items-center text-sm text-gray-600 mb-1">
                                <span class="material-icons text-green-500 mr-1 text-base">online_prediction</span>
                                Online
                            </div>
                            <p class="text-lg font-semibold text-green-500">Free</p>
                        </div>
                    </div>
                    <div class="mt-6 grid grid-cols-2 sm:grid-cols-5 gap-2">
                        <button class="col-span-2 sm:col-span-1 bg-pink-500 hover:bg-pink-600 text-white font-medium py-2 px-3 rounded-md flex items-center justify-center text-sm">
                            <span class="material-icons mr-1 text-base">person_add</span> Attend <span class="ml-1 bg-pink-700 text-white text-xs px-1.5 py-0.5 rounded-full">256</span>
                        </button>
                        <button class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-3 rounded-md text-sm">Details</button>
                        <button class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-3 rounded-md text-sm">Comments</button>
                        <button class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-3 rounded-md text-sm">Message</button>
                        <button class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-3 rounded-md text-sm">Share</button>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <div class="flex flex-col sm:flex-row items-start sm:items-center">
                        <div class="icon-placeholder flex-shrink-0 mr-6 mb-4 sm:mb-0">
                            <img alt="Event placeholder image" class="opacity-0 w-full h-full object-cover rounded-full" src="https://lh3.googleusercontent.com/aida-public/AB6AXuCINN8I_818FQUNZs_xPbYBApF32B1bqEhupxY-uz-TgD5ADzLdvshiuB1bElxfQhKlT9WQJcNX018dJBEAeqPfHhamm9fwuSuITHGOnEC1UCGOASk_X4EprqiHh2NXZKaz1q1AM-20yJ0IBBUdvnuPUvsca5O3qos7jRNap39OmyEmfZhnPOKmp7A3MRRjz2cg_5QLCgiFnWvsyo5Vtkgiwo0dy8X2f4sfTsbXUtuCf6R9b88cYTeuegj68KAUbWHFZtK4Y5KMR2U" />
                        </div>
                        <div class="flex-grow">
                            <div class="flex justify-between items-start mb-2">
                                <div>
                                    <p class="text-sm text-gray-500">Ethan Gray</p>
                                    <h2 class="text-2xl font-bold text-gray-800">Summer picnic in the park</h2>
                                </div>
                                <div class="flex items-center text-gray-500">
                                    <span class="material-icons text-yellow-400">star</span>
                                    <span class="material-icons text-yellow-400">star</span>
                                    <span class="material-icons text-yellow-400">star_half</span>
                                    <span class="material-icons text-gray-300">star_border</span>
                                    <span class="material-icons text-gray-300">star_border</span>
                                    <span class="ml-4 flex items-center text-sm">
                                        <span class="material-icons text-gray-400 mr-1">group</span> 14
                                    </span>
                                </div>
                            </div>
                            <p class="text-sm text-gray-500 mb-1">29 Oct 2024 - 31 Jan 2025</p>
                            <div class="flex items-center text-sm text-gray-600 mb-1">
                                <span class="material-icons text-gray-400 mr-1 text-base">location_on</span>
                                Kimberley
                            </div>
                            <p class="text-lg font-semibold text-pink-500">R 20.00</p>
                        </div>
                    </div>
                    <div class="mt-6 grid grid-cols-2 sm:grid-cols-5 gap-2">
                        <button class="col-span-2 sm:col-span-1 bg-pink-500 hover:bg-pink-600 text-white font-medium py-2 px-3 rounded-md flex items-center justify-center text-sm">
                            <span class="material-icons mr-1 text-base">person_add</span> Attend <span class="ml-1 bg-pink-700 text-white text-xs px-1.5 py-0.5 rounded-full">10</span>
                        </button>
                        <button class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-3 rounded-md text-sm">Details</button>
                        <button class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-3 rounded-md text-sm">Comments</button>
                        <button class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-3 rounded-md text-sm">Message</button>
                        <button class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-3 rounded-md text-sm">Share</button>
                    </div>
                </div>



@code {
    public bool IsLoading { get; set; }

    private List<Event> _events = new List<Event>();
    public UserModel? _userModel;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        try
        {
            if (firstRender)
            {
                _events = await _eventService.GetEventsAsync();
                StateHasChanged();
            }
        }
        catch (InvalidOperationException ex)
        {
            _logger.LogError(ex, "API error in GetEvents");
            // await HandleAlertChanged(new Alert("Event failed", ex.Message, AlertType.Error));
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Client logic error in GetEvents");
            // await HandleAlertChanged(new Alert("Event failed", "Get events failed: An unexpected error occurred.", AlertType.Error));
        }

        // await JS.InvokeVoidAsync("scrollToTop");

    }


    #region old
    // protected async override Task OnInitializedAsync()
    // {


    //     // _globalEventCallBacks.OnGetCurrentUserStateForNav += HandleGetCurrentUserState;
    //     // HandleGetCurrentUserState();
    // }

    // private void HandleGetCurrentUserState()
    // {
    //     _ = InvokeAsync(async () =>
    //     {
    //         _userModel = await _AuthStateProvider.GetCurrentUserState();
    //         StateHasChanged();
    //     });

    //     StateHasChanged();
    // }
    #endregion
}



    


@* 

@if (Alert != null)
{
    <AlertModal Alert="@Alert" OnAlertChanged="HandleAlertChanged"></AlertModal>
}

@code {





    private async Task HandleAlertChanged(Alert? alert)
    {
        Alert = alert;
        StateHasChanged();

        if (alert != null && alert.Type == AlertType.Success)
        {
            await Task.Delay(3000);
            Alert = null;
            StateHasChanged();
        }
    }

    private async Task HandleDelete(string eventId)
    {
        try
        {
            await _eventService.DeleteEventByIdAsync(eventId);
            var eventModel = _events.FirstOrDefault(x => x.Id == eventId);
            _events.Remove(eventModel);
            StateHasChanged();
        }
        catch (InvalidOperationException ex)
        {
            _logger.LogError(ex, "API error in GetEvents");
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Client logic error in GetEvents");
        }
    }
} *@